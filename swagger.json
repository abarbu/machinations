{"components":{"schemas":{"StateEdge":{"required":["from","to","active"],"properties":{"stateFormula":{"$ref":"#/components/schemas/StateFormula"},"to":{"$ref":"#/components/schemas/AnyLabel"},"resourceFilter":{"type":"string"},"active":{"type":"boolean"},"from":{"$ref":"#/components/schemas/AnyLabel"}},"type":"object"},"StateFormula":{"type":"object","oneOf":[{"required":["tag","contents"],"properties":{"contents":{"$ref":"#/components/schemas/StateFormula"},"tag":{"enum":["SFAdd"],"type":"string"}},"type":"object"},{"required":["tag","contents"],"properties":{"contents":{"$ref":"#/components/schemas/StateFormula"},"tag":{"enum":["SFSub"],"type":"string"}},"type":"object"},{"required":["tag","contents"],"properties":{"contents":{"$ref":"#/components/schemas/StateFormula"},"tag":{"enum":["SFMul"],"type":"string"}},"type":"object"},{"required":["tag","contents"],"properties":{"contents":{"$ref":"#/components/schemas/StateFormula"},"tag":{"enum":["SFDiv"],"type":"string"}},"type":"object"},{"required":["tag","contents"],"properties":{"contents":{"minItems":2,"items":[{"$ref":"#/components/schemas/Condition"},{"$ref":"#/components/schemas/StateFormula"}],"type":"array","maxItems":2},"tag":{"enum":["SFCondition"],"type":"string"}},"type":"object"},{"required":["tag","contents"],"properties":{"contents":{"$ref":"#/components/schemas/StateFormula"},"tag":{"enum":["SFOverwrite"],"type":"string"}},"type":"object"},{"required":["tag","contents"],"properties":{"contents":{"$ref":"#/components/schemas/StateFormula"},"tag":{"enum":["SFPercentage"],"type":"string"}},"type":"object"},{"required":["tag","contents"],"properties":{"contents":{"minItems":2,"items":[{"$ref":"#/components/schemas/StateFormula"},{"$ref":"#/components/schemas/StateFormula"}],"type":"array","maxItems":2},"tag":{"enum":["SFRange"],"type":"string"}},"type":"object"},{"required":["tag","contents"],"properties":{"contents":{"$ref":"#/components/schemas/StateFormula"},"tag":{"enum":["SFInterval"],"type":"string"}},"type":"object"},{"required":["tag","contents"],"properties":{"contents":{"minimum":-9223372036854775808,"type":"integer","maximum":9223372036854775807},"tag":{"enum":["SFConstant"],"type":"string"}},"type":"object"},{"required":["tag"],"properties":{"tag":{"enum":["SFTrigger"],"type":"string"}},"type":"object"},{"required":["tag"],"properties":{"tag":{"enum":["SFReverseTrigger"],"type":"string"}},"type":"object"},{"required":["tag","contents"],"properties":{"contents":{"type":"string"},"tag":{"enum":["SFVariable"],"type":"string"}},"type":"object"}]},"ResourceEdge":{"required":["from","to","resourceFormula","interval","transfer","shuffleOrigin","limits"],"properties":{"to":{"minimum":-9223372036854775808,"type":"integer","maximum":9223372036854775807},"resourceFilter":{"type":"string"},"interval":{"$ref":"#/components/schemas/Interval"},"resourceFormula":{"$ref":"#/components/schemas/ResourceFormula"},"from":{"minimum":-9223372036854775808,"type":"integer","maximum":9223372036854775807},"limits":{"$ref":"#/components/schemas/Limits"},"shuffleOrigin":{"type":"boolean"},"transfer":{"$ref":"#/components/schemas/TransferType"}},"type":"object"},"Formula":{"type":"object","oneOf":[{"required":["tag","contents"],"properties":{"contents":{"type":"string"},"tag":{"enum":["FVar"],"type":"string"}},"type":"object"},{"required":["tag","contents"],"properties":{"contents":{"minimum":-9223372036854775808,"type":"integer","maximum":9223372036854775807},"tag":{"enum":["FConstant"],"type":"string"}},"type":"object"},{"required":["tag","contents"],"properties":{"contents":{"minItems":2,"items":[{"$ref":"#/components/schemas/Formula"},{"$ref":"#/components/schemas/Formula"}],"type":"array","maxItems":2},"tag":{"enum":["FApply"],"type":"string"}},"type":"object"},{"required":["tag","contents"],"properties":{"contents":{"minItems":2,"items":[{"$ref":"#/components/schemas/Formula"},{"$ref":"#/components/schemas/Formula"}],"type":"array","maxItems":2},"tag":{"enum":["FPair"],"type":"string"}},"type":"object"},{"required":["tag","contents"],"properties":{"contents":{"$ref":"#/components/schemas/Formula"},"tag":{"enum":["FNeg"],"type":"string"}},"type":"object"},{"required":["tag","contents"],"properties":{"contents":{"minItems":2,"items":[{"$ref":"#/components/schemas/Formula"},{"$ref":"#/components/schemas/Formula"}],"type":"array","maxItems":2},"tag":{"enum":["FAdd"],"type":"string"}},"type":"object"},{"required":["tag","contents"],"properties":{"contents":{"minItems":2,"items":[{"$ref":"#/components/schemas/Formula"},{"$ref":"#/components/schemas/Formula"}],"type":"array","maxItems":2},"tag":{"enum":["FSub"],"type":"string"}},"type":"object"},{"required":["tag","contents"],"properties":{"contents":{"minItems":2,"items":[{"$ref":"#/components/schemas/Formula"},{"$ref":"#/components/schemas/Formula"}],"type":"array","maxItems":2},"tag":{"enum":["FMul"],"type":"string"}},"type":"object"},{"required":["tag","contents"],"properties":{"contents":{"minItems":2,"items":[{"$ref":"#/components/schemas/Formula"},{"$ref":"#/components/schemas/Formula"}],"type":"array","maxItems":2},"tag":{"enum":["FDiv"],"type":"string"}},"type":"object"}]},"Waiting":{"required":["startTime","resource"],"properties":{"startTime":{"minimum":-9223372036854775808,"type":"integer","maximum":9223372036854775807},"resource":{"$ref":"#/components/schemas/Resource"}},"type":"object"},"TransferType":{"enum":["IntervalTransfer","InstantTransfer"],"type":"string"},"PullAction":{"enum":["PullAny","PullAll"],"type":"string"},"Condition":{"enum":["CEqual","CNotEqual","CGt","CLt","CGtEq","CLtEq"],"type":"string"},"AnyLabel":{"minimum":-9223372036854775808,"type":"integer","maximum":9223372036854775807},"XMLConversionResult":{"properties":{"machine":{"$ref":"#/components/schemas/Machination"}},"type":"object"},"Node":{"required":["nodeTy","nodeLabel","nodeColor"],"properties":{"nodeColor":{"type":"string"},"nodeLabel":{"type":"string"},"nodeTy":{"$ref":"#/components/schemas/NodeType"}},"type":"object"},"Machination":{"required":["graph","resourceTagColor","time","seed"],"properties":{"seed":{"minimum":-9223372036854775808,"type":"integer","maximum":9223372036854775807},"resourceTagColor":{"type":"object","additionalProperties":{"type":"string"}},"graph":{"$ref":"#/components/schemas/Graph"},"stateEdgeModifiers":{"$ref":"#/components/schemas/StateEdgeModifiers"},"time":{"minimum":-9223372036854775808,"type":"integer","maximum":9223372036854775807}},"type":"object"},"Interval":{"required":["intervalFormula","intervalCounter"],"properties":{"intervalFormula":{"$ref":"#/components/schemas/ResourceFormula"},"intervalCounter":{"minimum":-9223372036854775808,"type":"integer","maximum":9223372036854775807}},"type":"object"},"XMLFile":{"required":["xmlContents"],"properties":{"xmlContents":{"type":"string"}},"type":"object"},"Overflow":{"enum":["OverflowBlock","OverflowDrain"],"type":"string"},"RunMachination":{"required":["machine","activeNodes"],"properties":{"machine":{"$ref":"#/components/schemas/Machination"},"activeNodes":{"items":{"minimum":-9223372036854775808,"type":"integer","maximum":9223372036854775807},"uniqueItems":true,"type":"array"}},"type":"object"},"ResourceFormula":{"type":"object","oneOf":[{"required":["tag"],"properties":{"tag":{"enum":["RFAll"],"type":"string"}},"type":"object"},{"required":["tag","contents"],"properties":{"contents":{"minItems":2,"items":[{"$ref":"#/components/schemas/ResourceFormula"},{"$ref":"#/components/schemas/ResourceFormula"}],"type":"array","maxItems":2},"tag":{"enum":["RFMultiply"],"type":"string"}},"type":"object"},{"required":["tag","contents"],"properties":{"contents":{"minItems":2,"items":[{"$ref":"#/components/schemas/ResourceFormula"},{"$ref":"#/components/schemas/ResourceFormula"}],"type":"array","maxItems":2},"tag":{"enum":["RFDivide"],"type":"string"}},"type":"object"},{"required":["tag","contents"],"properties":{"contents":{"minItems":2,"items":[{"$ref":"#/components/schemas/ResourceFormula"},{"$ref":"#/components/schemas/ResourceFormula"}],"type":"array","maxItems":2},"tag":{"enum":["RFAdd"],"type":"string"}},"type":"object"},{"required":["tag","contents"],"properties":{"contents":{"minItems":2,"items":[{"$ref":"#/components/schemas/ResourceFormula"},{"$ref":"#/components/schemas/ResourceFormula"}],"type":"array","maxItems":2},"tag":{"enum":["RFSubtract"],"type":"string"}},"type":"object"},{"required":["tag","contents"],"properties":{"contents":{"$ref":"#/components/schemas/ResourceFormula"},"tag":{"enum":["RFNegation"],"type":"string"}},"type":"object"},{"required":["tag","contents"],"properties":{"contents":{"$ref":"#/components/schemas/ResourceFormula"},"tag":{"enum":["RFPercentage"],"type":"string"}},"type":"object"},{"required":["tag","contents"],"properties":{"contents":{"minItems":2,"items":[{"$ref":"#/components/schemas/ResourceFormula"},{"$ref":"#/components/schemas/ResourceFormula"}],"type":"array","maxItems":2},"tag":{"enum":["RFDice"],"type":"string"}},"type":"object"},{"required":["tag","contents"],"properties":{"contents":{"minimum":-9223372036854775808,"type":"integer","maximum":9223372036854775807},"tag":{"enum":["RFConstant"],"type":"string"}},"type":"object"},{"required":["tag","contents"],"properties":{"contents":{"minItems":2,"items":[{"$ref":"#/components/schemas/Condition"},{"$ref":"#/components/schemas/ResourceFormula"}],"type":"array","maxItems":2},"tag":{"enum":["RFCondition"],"type":"string"}},"type":"object"}]},"NodeActivation":{"enum":["Passive","Interactive","Automatic","OnStart"],"type":"string"},"Graph":{"required":["vertices","resourceEdges","stateEdges"],"properties":{"stateEdges":{"type":"object","additionalProperties":{"$ref":"#/components/schemas/StateEdge"}},"vertices":{"type":"object","additionalProperties":{"$ref":"#/components/schemas/Node"}},"resourceEdges":{"type":"object","additionalProperties":{"$ref":"#/components/schemas/ResourceEdge"}}},"type":"object"},"Limits":{"properties":{"lower":{"minimum":-9223372036854775808,"type":"integer","maximum":9223372036854775807},"upper":{"minimum":-9223372036854775808,"type":"integer","maximum":9223372036854775807}},"type":"object"},"NodeType":{"type":"object","oneOf":[{"required":["activation","resourceTypes","tag"],"properties":{"resourceTypes":{"items":{"type":"string"},"uniqueItems":true,"type":"array"},"activation":{"$ref":"#/components/schemas/NodeActivation"},"tag":{"enum":["Source"],"type":"string"}},"type":"object"},{"required":["activation","pullAction","tag"],"properties":{"pullAction":{"$ref":"#/components/schemas/PullAction"},"activation":{"$ref":"#/components/schemas/NodeActivation"},"tag":{"enum":["Drain"],"type":"string"}},"type":"object"},{"required":["activation","pushPullAction","resources","overflow","tag"],"properties":{"activation":{"$ref":"#/components/schemas/NodeActivation"},"overflow":{"$ref":"#/components/schemas/Overflow"},"resources":{"items":{"$ref":"#/components/schemas/Resource"},"uniqueItems":true,"type":"array"},"pushPullAction":{"$ref":"#/components/schemas/PushPullAction"},"limit":{"minimum":-9223372036854775808,"type":"integer","maximum":9223372036854775807},"tag":{"enum":["Pool"],"type":"string"}},"type":"object"},{"required":["activation","pullAction","distribution","tag"],"properties":{"pullAction":{"$ref":"#/components/schemas/PullAction"},"distribution":{"$ref":"#/components/schemas/DistributionType"},"activation":{"$ref":"#/components/schemas/NodeActivation"},"tag":{"enum":["Gate"],"type":"string"}},"type":"object"},{"required":["activation","tag"],"properties":{"activation":{"$ref":"#/components/schemas/NodeActivation"},"tag":{"enum":["Trader"],"type":"string"}},"type":"object"},{"required":["activation","pullAction","resourceTypes","storage","tag"],"properties":{"resourceTypes":{"items":{"type":"string"},"uniqueItems":true,"type":"array"},"pullAction":{"$ref":"#/components/schemas/PullAction"},"activation":{"$ref":"#/components/schemas/NodeActivation"},"storage":{"type":"object","additionalProperties":{"items":{"$ref":"#/components/schemas/Resource"},"uniqueItems":true,"type":"array"}},"tag":{"enum":["Converter"],"type":"string"}},"type":"object"},{"required":["registerFormula","limits","tag"],"properties":{"registerFormula":{"$ref":"#/components/schemas/Formula"},"limits":{"$ref":"#/components/schemas/Limits"},"tag":{"enum":["RegisterFn"],"type":"string"}},"type":"object"},{"required":["initial","step","currentValue","limits","tag"],"properties":{"limits":{"$ref":"#/components/schemas/Limits"},"initial":{"minimum":-9223372036854775808,"type":"integer","maximum":9223372036854775807},"tag":{"enum":["RegisterInteractive"],"type":"string"},"currentValue":{"minimum":-9223372036854775808,"type":"integer","maximum":9223372036854775807},"step":{"minimum":-9223372036854775808,"type":"integer","maximum":9223372036854775807}},"type":"object"},{"required":["activation","waitingResources","tag"],"properties":{"waitingResources":{"items":{"$ref":"#/components/schemas/Waiting"},"type":"array"},"activation":{"$ref":"#/components/schemas/NodeActivation"},"tag":{"enum":["Delay"],"type":"string"}},"type":"object"},{"required":["activation","waitingResources","tag"],"properties":{"nextTimeAvailable":{"minimum":-9223372036854775808,"type":"integer","maximum":9223372036854775807},"waitingResources":{"items":{"$ref":"#/components/schemas/Waiting"},"type":"array"},"activation":{"$ref":"#/components/schemas/NodeActivation"},"tag":{"enum":["Queue"],"type":"string"}},"type":"object"},{"required":["tag"],"properties":{"tag":{"enum":["EndCondition"],"type":"string"}},"type":"object"}]},"PushAction":{"enum":["PushAny","PushAll"],"type":"string"},"StateEdgeModifiers":{"required":["triggerNode","enableNode","disableNode","enableResourceEdge","disableResourceEdge","modifyResourceFormula","modifyNode"],"properties":{"disableNode":{"items":{"minimum":-9223372036854775808,"type":"integer","maximum":9223372036854775807},"uniqueItems":true,"type":"array"},"modifyResourceFormula":{"type":"object","additionalProperties":{"items":{"$ref":"#/components/schemas/StateFormula"},"uniqueItems":true,"type":"array"}},"enableNode":{"items":{"minimum":-9223372036854775808,"type":"integer","maximum":9223372036854775807},"uniqueItems":true,"type":"array"},"enableResourceEdge":{"items":{"minimum":-9223372036854775808,"type":"integer","maximum":9223372036854775807},"uniqueItems":true,"type":"array"},"triggerNode":{"items":{"minimum":-9223372036854775808,"type":"integer","maximum":9223372036854775807},"uniqueItems":true,"type":"array"},"modifyNode":{"type":"object","additionalProperties":{"items":{"$ref":"#/components/schemas/StateFormula"},"uniqueItems":true,"type":"array"}},"disableResourceEdge":{"items":{"minimum":-9223372036854775808,"type":"integer","maximum":9223372036854775807},"uniqueItems":true,"type":"array"}},"type":"object"},"RunResult":{"required":["machine","activatedEdges","failedEdges","activatedNodes","failedNodes","triggeredEdges","edgeflow","generatedResources","killedResources","errors"],"properties":{"triggeredEdges":{"items":{"minimum":-9223372036854775808,"type":"integer","maximum":9223372036854775807},"uniqueItems":true,"type":"array"},"activatedNodes":{"items":{"minimum":-9223372036854775808,"type":"integer","maximum":9223372036854775807},"uniqueItems":true,"type":"array"},"generatedResources":{"items":{"$ref":"#/components/schemas/Resource"},"uniqueItems":true,"type":"array"},"failedEdges":{"items":{"minimum":-9223372036854775808,"type":"integer","maximum":9223372036854775807},"uniqueItems":true,"type":"array"},"failedNodes":{"items":{"minimum":-9223372036854775808,"type":"integer","maximum":9223372036854775807},"uniqueItems":true,"type":"array"},"machine":{"$ref":"#/components/schemas/Machination"},"edgeflow":{"type":"object","additionalProperties":{"items":{"$ref":"#/components/schemas/Resource"},"uniqueItems":true,"type":"array"}},"ended":{"minimum":-9223372036854775808,"type":"integer","maximum":9223372036854775807},"errors":{"type":"object","additionalProperties":{"type":"string"}},"activatedEdges":{"items":{"minimum":-9223372036854775808,"type":"integer","maximum":9223372036854775807},"uniqueItems":true,"type":"array"},"killedResources":{"items":{"$ref":"#/components/schemas/Resource"},"uniqueItems":true,"type":"array"}},"type":"object"},"PushPullAction":{"type":"object","oneOf":[{"required":["tag","contents"],"properties":{"contents":{"$ref":"#/components/schemas/PushAction"},"tag":{"enum":["Pushing"],"type":"string"}},"type":"object"},{"required":["tag","contents"],"properties":{"contents":{"$ref":"#/components/schemas/PullAction"},"tag":{"enum":["Pulling"],"type":"string"}},"type":"object"}]},"Resource":{"required":["tag","uUID"],"properties":{"uUID":{"type":"string"},"tag":{"type":"string"}},"type":"object"},"DistributionType":{"type":"object","oneOf":[{"type":"object","allOf":[{"required":["tag"],"properties":{"tag":{"enum":["Deterministic"],"type":"string"}},"type":"object"},{"minItems":2,"items":[{"minItems":2,"items":[{"type":"object","additionalProperties":{"minimum":-9223372036854775808,"type":"integer","maximum":9223372036854775807}},{"minimum":-9223372036854775808,"type":"integer","maximum":9223372036854775807}],"type":"array","maxItems":2},{"minimum":-9223372036854775808,"type":"integer","maximum":9223372036854775807}],"type":"array","maxItems":2}]},{"required":["tag"],"properties":{"tag":{"enum":["Random"],"type":"string"}},"type":"object"}]}}},"info":{"title":"Machinations API","version":"2021","description":"Run and visualize machinations"},"openapi":"3.0.0","paths":{"/api/convertxml":{"post":{"requestBody":{"content":{"application/json;charset=utf-8":{"schema":{"$ref":"#/components/schemas/XMLFile"}}}},"responses":{"400":{"description":"Invalid `body`"},"200":{"content":{"application/json;charset=utf-8":{"schema":{"$ref":"#/components/schemas/XMLConversionResult"}}},"description":""}}}},"/api/run":{"post":{"requestBody":{"content":{"application/json;charset=utf-8":{"schema":{"$ref":"#/components/schemas/RunMachination"}}}},"responses":{"400":{"description":"Invalid `body`"},"200":{"content":{"application/json;charset=utf-8":{"schema":{"$ref":"#/components/schemas/RunResult"}}},"description":""}}}},"/api/test":{"get":{"responses":{"200":{"content":{"application/json;charset=utf-8":{"schema":{"type":"string"}}},"description":""}}}},"/api/render":{"post":{"requestBody":{"content":{"application/json;charset=utf-8":{"schema":{"$ref":"#/components/schemas/Machination"}}}},"responses":{"400":{"description":"Invalid `body`"},"200":{"content":{"application/json;charset=utf-8":{"schema":{"type":"string"}}},"description":""}}}}}}